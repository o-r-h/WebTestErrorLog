USE DemoETL
GO

DECLARE @i bigint =1;
truncate table registro;
truncate table Registro_Ite1;
truncate table Registro_Ite2;

--CARGA INICIAL
WHILE @i <= 10
BEGIN
	INSERT INTO Registro (id,nombre, fecha, fechacreacion, estado)
	VALUES (@i,'ALFA' + CAST(@i as varchar(2)), GETDATE(),GETDATE(),0) 
	set @i = @i+1;
END


--CARGA ITERACION 1, SE AGREGAN 10 REGISTROS NUEVOS Y SE ELIMINAN 3
DECLARE @i2 bigint =1;
WHILE @i2 <= 20
BEGIN
	INSERT INTO Registro_Ite1 (id,nombre, fecha)
	VALUES (@i2,'ALFA' + CAST(@i2 as varchar(2)),  DATEADD(day, 1, Getdate())) 
	set @i2 = @i2+1;
END
DELETE FROM Registro_Ite1 WHERE ID <=3
SELECT * FROM Registro
SELECT * FROM Registro_Ite1


--  CONSULTA
DECLARE @FechaInicio AS DATETIME ='2024-09-06'
DECLARE @FechaFin AS DATETIME ='2024-09-09'

SELECT * FROM Registro
WHERE FechaCreacion BETWEEN @FechaInicio AND @FechaFin
AND (FechaEliminacion IS NULL OR FechaEliminacion <> FechaCreacion);

